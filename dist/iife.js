var VueSimpleSuggest=function(u){"use strict";var t={selectionUp:[38],selectionDown:[40],select:[13],hideList:[27],showList:[40],autocomplete:[32,13]},e={input:String,select:Object};function n(t,e){return s(t,e.keyCode)}function s(t,e){var i;return!(t.length<=0)&&(i=function(t){return t.some(function(t){return t===e})},Array.isArray(t[0])?t.some(i):i(t))}var o=/^on[^a-z]/;function r(t,e){return void 0!==t?(i=t,e.split(".").reduce(function(t,e){return t===Object(t)?t[e]:t},i)):t;var i}function l(t,e,i){return i?t:(void 0===(i=r(t,e))&&(i=JSON.stringify(t),process)&&~process.env.NODE_ENV.indexOf("dev")&&console.warn("[vue-simple-suggest]: Please, provide `display-attribute` as a key or a dotted path for a property from your object."),String(i||""))}var i="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return setTimeout(t,16)}:function(t){return setTimeout(t,0)},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i,s=arguments[e];for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t};function a(){}function d(t,e){t=t();return t&&t.then?t.then(e):e(t)}function m(t,e,i){return i?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t)}function p(t,e){try{var i=t()}catch(t){return e(t)}return i&&i.then?i.then(void 0,e):i}function f(t,e){try{var i=t()}catch(t){return e()}return i&&i.then?i.then(e,e):e()}var g={name:"vue-simple-suggest",inheritAttrs:!1,props:{styles:{type:Object,default:function(){return{}}},controls:{type:Object,default:function(){return t}},minLength:{type:Number,default:1},maxSuggestions:{type:Number,default:10},displayAttribute:{type:String,default:"title"},valueAttribute:{type:String,default:"id"},list:{type:[Function,Array],default:function(){return[]}},removeList:{type:Boolean,default:!1},destyled:{type:Boolean,default:!1},filterByQuery:{type:Boolean,default:!1},filter:{type:Function},debounce:{type:Number,default:0},nullableSelect:{type:Boolean,default:!1},modelValue:{},modelSelect:{},mode:{type:String,default:"input",validator:function(t){return!!~Object.keys(e).indexOf(t.toLowerCase())}},preventHide:{type:Boolean,default:!1}},watch:{mode:{handler:function(){var t=this;this.$parent&&this.$parent.$forceUpdate(),this.$nextTick(function(){t.$emit("update:modelValue",t.text),t.$emit("update:modelSelect",t.selected),t.$emit("select",t.selected)})},immediate:!0},filter:{handler:function(t){var i=this;this.filterResult=null!=t?t:function(t,e){return!e||~l(t,i.displayAttribute).toLowerCase().indexOf(e.toLowerCase())}},immediate:!0},modelValue:{handler:function(t){"input"===this.mode&&("string"!=typeof t&&(t=this.displayProperty(t)),this.updateTextOutside(t))},immediate:!0},modelSelect:{handler:function(t){"select"===this.mode&&("string"!=typeof t&&(t=this.displayProperty(t)),this.updateTextOutside(t))},immediate:!0}},data:function(t){return{filterResult:null,selected:null,hovered:null,suggestions:[],listShown:!1,inputElement:null,canSend:!0,timeoutInstance:null,text:t.modelValue,isPlainSuggestion:!1,isClicking:!1,isInFocus:!1,isFalseFocus:!1,isTabbed:!1,controlScheme:{},listId:this.$.uid+"-suggestions"}},computed:{listIsRequest:function(){return"function"==typeof this.list},hoveredIndex:function(){for(var t=0;t<this.suggestions.length;t++){var e=this.suggestions[t];if(this.hovered&&this.valueProperty(this.hovered)==this.valueProperty(e))return t}return-1},textLength:function(){return this.text&&this.text.length||this.inputElement&&this.inputElement.value.length||0},isSelectedUpToDate:function(){return!!this.selected&&this.displayProperty(this.selected)===this.text},attrsWithoutListeners:function(){var e=this,i={};return Object.keys(this.$attrs).forEach(function(t){return!o.test(t)&&(i[t]=e.$attrs[t])}),i},field:function(){return h({},this.attrsWithoutListeners,{onBlur:this.onBlur,onFocus:this.onFocus,onInput:this.onInput,onClick:this.showSuggestions,onKeydown:this.onKeyDown,onKeyup:this.onListKeyUp})},componentField:function(){return h({},this.attrsWithoutListeners,{onBlur:this.onBlur,onFocus:this.onFocus,"onUpdate:modelValue":this.onInput,onClick:this.showSuggestions,onKeydown:this.onKeyDown,onKeyup:this.onListKeyUp})}},created:function(){this.controlScheme=h({},t,this.controls)},mounted:function(){var t=this;this.$nextTick(function(){return i(function(){t.inputElement=t.$refs.inputSlot.querySelector("input"),t.inputElement?t.setInputAriaAttributes():console.error("No input element found")})})},methods:{isEqual:function(t,e){return e&&this.valueProperty(t)==this.valueProperty(e)},isSelected:function(t){return this.isEqual(t,this.selected)},isHovered:function(t){return this.isEqual(t,this.hovered)},setInputAriaAttributes:function(){this.inputElement&&(this.inputElement.setAttribute("aria-activedescendant",""),this.inputElement.setAttribute("aria-autocomplete","list"),this.inputElement.setAttribute("aria-controls",this.listId))},isScopedSlotEmpty:function(t){return!t||t(this).some(function(t){return t.type!==Comment&&!(Array.isArray(t.children)&&!t.children.length)&&(t.type!==Text||"string"==typeof t.children&&""!==t.children.trim())})},miscSlotsAreEmpty:function(){var e=this,t=["misc-item-above","misc-item-below"].map(function(t){return e.$slots[t]});return t.every(function(t){return!!t})?t.every(this.isScopedSlotEmpty.bind(this)):(t=t.find(function(t){return!!t}),this.isScopedSlotEmpty.call(this,t))},displayProperty:function(t){return l(t,this.displayAttribute)},valueProperty:function(t){return this.isPlainSuggestion||void 0===(t=r(t,this.valueAttribute))&&console.error("[vue-simple-suggest]: Please, check if you passed 'value-attribute' (default is 'id') and 'display-attribute' (default is 'title') props correctly.\n        Your list objects should always contain a unique identifier."),t},autocompleteText:function(t){this.setText(this.displayProperty(t))},setText:function(t){var e=this;this.$nextTick(function(){e.inputElement&&(e.inputElement.value=t),e.text=t,e.$emit("update:modelValue",t)})},select:function(t){(t&&this.selected!==t||this.nullableSelect&&!t)&&(this.selected=t,this.$emit("update:modelSelect",t),this.$emit("select",t),t)&&this.autocompleteText(t),this.hover(null)},hover:function(t,e){var i=t?this.getId(t,this.hoveredIndex):"";this.inputElement&&this.inputElement.setAttribute("aria-activedescendant",i),t&&t!==this.hovered&&this.$emit("hover",t,e),this.hovered=t},hideList:function(){this.listShown&&(this.listShown=!1,this.hover(null),this.$emit("hide-list"))},showList:function(){this.listShown||this.textLength>=this.minLength&&(0<this.suggestions.length||!this.miscSlotsAreEmpty())&&(this.listShown=!0,this.$emit("show-list"))},showSuggestions:function(){try{var e=this;return m(d(function(){if(0===e.suggestions.length&&e.minLength<=e.textLength){e.showList();var t=e.research();if(!void 0)return t&&t.then?t.then(a):Promise.resolve()}},function(){e.showList()}))}catch(t){return Promise.reject(t)}},onShowList:function(t){n(this.controlScheme.showList,t)&&this.showSuggestions()},moveSelection:function(t){var e,i,s;this.listShown&&this.suggestions.length&&n([this.controlScheme.selectionUp,this.controlScheme.selectionDown],t)&&(t.preventDefault(),e=(t=n(this.controlScheme.selectionDown,t))?0:this.suggestions.length-1,i=t?this.hoveredIndex<this.suggestions.length-1:0<this.hoveredIndex,s=null,s=this.hovered?i?this.suggestions[this.hoveredIndex+(2*t-1)]:this.suggestions[e]:this.selected||this.suggestions[e],this.hover(s))},onKeyDown:function(t){var e=this.controlScheme.select,i=this.controlScheme.hideList;"Enter"===t.key&&this.listShown&&s([e,i],13)&&t.preventDefault(),"Tab"===t.key&&this.hovered&&this.select(this.hovered),this.onShowList(t),this.moveSelection(t),this.onAutocomplete(t)},onListKeyUp:function(t){var e=this.controlScheme.select,i=this.controlScheme.hideList;this.listShown&&n([e,i],t)&&(t.preventDefault(),n(e,t)&&this.select(this.hovered),this.hideList())},onAutocomplete:function(t){n(this.controlScheme.autocomplete,t)&&(t.ctrlKey||t.shiftKey)&&0<this.suggestions.length&&this.suggestions[0]&&this.listShown&&(t.preventDefault(),this.hover(this.suggestions[0]),this.autocompleteText(this.suggestions[0]))},suggestionClick:function(t,e){var i=this;this.$emit("suggestion-click",t,e),this.select(t),this.preventHide||this.hideList(),this.isClicking&&setTimeout(function(){i.inputElement&&i.inputElement.focus(),i.isClicking=!1},0)},onBlur:function(t){this.isInFocus?(this.isClicking=this.hovered&&!this.isTabbed,this.isClicking?t&&t.isTrusted&&!this.isTabbed&&(this.isFalseFocus=!0):(this.isInFocus=!1,this.hideList(),this.$emit("blur",t))):(this.inputElement&&this.inputElement.blur(),console.error("This should never happen!\n          If you encountered this error, please make sure that your input component emits 'focus' events properly.\n          For more info see https://github.com/KazanExpress/vue-simple-suggest#custom-input.\n\n          If your 'vue-simple-suggest' setup does not include a custom input component - please,\n          report to https://github.com/KazanExpress/vue-simple-suggest/issues/new")),this.isTabbed=!1},onFocus:function(t){this.isInFocus=!0,t&&!this.isFalseFocus&&this.$emit("focus",t),this.isClicking||this.isFalseFocus||this.showSuggestions(),this.isFalseFocus=!1},onInput:function(t){t=t.target?t.target.value:t;this.updateTextOutside(t),this.$emit("update:modelValue",t)},updateTextOutside:function(t){this.text!==t&&(this.text=t,this.hovered&&this.hover(null),this.text.length<this.minLength?this.hideList():this.debounce?(clearTimeout(this.timeoutInstance),this.timeoutInstance=setTimeout(this.research,this.debounce)):this.research())},research:function(){try{var i=this;return m(f(function(){return p(function(){var t=function(){var e;if(i.canSend)return i.canSend=!1,e=i.text,m(i.getSuggestions(i.text),function(t){e===i.text&&(i.suggestions=t)})};if((t=t())&&t.then)return t.then(a)},function(t){throw i.clearSuggestions(),t})},function(){return i.canSend=!0,0===i.suggestions.length&&i.miscSlotsAreEmpty()?i.hideList():i.isInFocus&&i.showList(),i.suggestions}))}catch(t){return Promise.reject(t)}},getSuggestions:function(e){try{var i=this;if((e=e||"").length<i.minLength)return m([]);i.selected=null,i.listIsRequest&&i.$emit("request-start",e);var t=!1,s=[];return m(f(function(){return p(function(){return d(function(){if(i.listIsRequest)return m(i.list(e),function(t){s=t||[]});s=i.list},function(){Array.isArray(s)||(s=[s]),t="object"!==c(s[0])&&void 0!==s[0]||Array.isArray(s[0]),i.filterByQuery&&(s=s.filter(function(t){return i.filterResult(t,e)})),i.listIsRequest&&i.$emit("request-done",s)})},function(t){if(!i.listIsRequest)throw t;i.$emit("request-failed",t)})},function(){return i.maxSuggestions&&(s=s.slice(0,i.maxSuggestions)),i.isPlainSuggestion=t,s}))}catch(t){return Promise.reject(t)}},clearSuggestions:function(){this.suggestions.splice(0)},getId:function(t,e){return this.listId+"-suggestion-"+(!this.isPlainSuggestion&&this.valueProperty(t)||e)}}},y=["aria-owns","aria-expanded"],v=["value"],S=["id","aria-labelledby"],b=["onMouseenter","onClick","aria-selected","id"];return g.render=function(i,s,n,t,o,r){return u.openBlock(),u.createElementBlock("div",{class:u.normalizeClass(["vue-simple-suggest",[n.styles.vueSimpleSuggest,{designed:!n.destyled,focus:o.isInFocus}]]),onKeydown:s[1]||(s[1]=u.withKeys(function(t){return o.isTabbed=!0},["tab"]))},[u.createElementVNode("div",{class:u.normalizeClass(["input-wrapper",n.styles.inputWrapper]),ref:"inputSlot",role:"combobox","aria-haspopup":"listbox","aria-owns":o.listId,"aria-expanded":o.listShown&&!n.removeList?"true":"false"},[u.renderSlot(i.$slots,"default",{field:r.field,componentField:r.componentField},function(){return[u.createElementVNode("input",u.mergeProps({class:"default-input"},r.field,{value:o.text||"",class:n.styles.defaultInput}),null,16,v)]})],10,y),u.createVNode(u.Transition,{name:"vue-simple-suggest"},{default:u.withCtx(function(){return[o.listShown&&!n.removeList?(u.openBlock(),u.createElementBlock("ul",{key:0,id:o.listId,class:u.normalizeClass(["suggestions",n.styles.suggestions]),role:"listbox","aria-labelledby":o.listId},[i.$slots["misc-item-above"]?(u.openBlock(),u.createElementBlock("li",{key:0,class:u.normalizeClass(n.styles.miscItemAbove)},[u.renderSlot(i.$slots,"misc-item-above",{suggestions:o.suggestions,query:o.text})],2)):u.createCommentVNode("v-if",!0),(u.openBlock(!0),u.createElementBlock(u.Fragment,null,u.renderList(o.suggestions,function(e,t){return u.openBlock(),u.createElementBlock("li",{class:u.normalizeClass(["suggest-item",[n.styles.suggestItem,{selected:r.isSelected(e),hover:r.isHovered(e)}]]),role:"option",onMouseenter:function(t){return r.hover(e,t.target)},onMouseleave:s[0]||(s[0]=function(t){return r.hover(null)}),onClick:function(t){return r.suggestionClick(e,t)},"aria-selected":r.isHovered(e)||r.isSelected(e)?"true":"false",id:r.getId(e,t),key:r.getId(e,t)},[u.renderSlot(i.$slots,"suggestion-item",{autocomplete:function(){return r.autocompleteText(e)},suggestion:e,query:o.text},function(){return[u.createElementVNode("span",null,u.toDisplayString(r.displayProperty(e)),1)]})],42,b)}),128)),i.$slots["misc-item-below"]?(u.openBlock(),u.createElementBlock("li",{key:1,class:u.normalizeClass(n.styles.miscItemBelow)},[u.renderSlot(i.$slots,"misc-item-below",{suggestions:o.suggestions,query:o.text})],2)):u.createCommentVNode("v-if",!0)],10,S)):u.createCommentVNode("v-if",!0)]}),_:3})],34)},g.__file="lib/vue-simple-suggest.vue",(Vue||window&&window.Vue)&&(Vue||window.Vue).component("vue-simple-suggest",g),g}(Vue);
